<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Mestre - Dungeon Hunters</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        body { background: #1a1a1a; color: white; font-family: sans-serif; padding: 20px; }
        .admin-card { background: #252525; padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 5px solid #7289da; }
        select, input { padding: 10px; border-radius: 5px; margin-top: 5px; width: 100%; background: #000; color: #fff; border: 1px solid #444; }
        button { background: #7289da; color: white; border: none; padding: 10px; width: 100%; border-radius: 5px; margin-top: 10px; font-weight: bold; }
        .senha-box { margin-bottom: 30px; border: 1px dashed #555; padding: 15px; }
    </style>
</head>
<body>
    <h2>Admin - Dungeon Hunters</h2>
    <div class="senha-box">
        <label>Senha de Mestre:</label>
        <input type="password" id="adminPass" placeholder="Senha para salvar alterações">
    </div>
    <div id="listaEdicao">Carregando jogadores...</div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAsq9HAbLMReGnDX9jfRnChPF-R0f0rDfA",
            authDomain: "dungeon-hunters-15a90.firebaseapp.com",
            databaseURL: "https://dungeon-hunters-15a90-default-rtdb.firebaseio.com",
            projectId: "dungeon-hunters-15a90",
            storageBucket: "dungeon-hunters-15a90.firebasestorage.app",
            messagingSenderId: "386699061769",
            appId: "1:386699061769:web:30f9023befc43da2ab66d8"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const RANKS = ["Cobre", "Ferro", "Prata", "Ouro", "Platina", "Mithril", "Orichalcum", "Adamantite", "Master"];

        db.ref('players').on('value', snap => {
            let html = "";
            snap.forEach(child => {
                let p = child.val();
                let options = RANKS.map(r => `<option value="${r}" ${p.rank === r ? 'selected' : ''}>${r}</option>`).join('');
                html += `
                <div class="admin-card">
                    <strong>Aventureiro: ${p.name}</strong><br>
                    <small>Andar Atual: ${p.floor}º</small><br>
                    <select id="rank-${p.name}">${options}</select>
                    <button onclick="salvarRank('${p.name}')">Atualizar Rank</button>
                </div>`;
            });
            document.getElementById('listaEdicao').innerHTML = html || "Nenhum jogador online.";
        });

        function salvarRank(nome) {
            const senha = document.getElementById('adminPass').value;
            if(senha !== "hunters123") return alert("Senha de mestre incorreta!");
            const novoRank = document.getElementById(`rank-${nome}`).value;
            db.ref('players/' + nome).update({ rank: novoRank }).then(() => alert("Rank de " + nome + " atualizado!"));
        }
    </script>
</body>
</html>
